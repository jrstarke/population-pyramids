Modernizr.svg&&Modernizr.inlinesvg?d3.json("/regions.json",function(e){var t={};e.forEach(function(e){t[e.n.toLowerCase()]=e.i});var n=function(t){$(t).typeahead({source:e.map(function(e){return e.n})}),$(t).change(function(e){h()}),$(t).submit(function(e){e.preventDefault(),h()}),$(t).keydown(function(e){e.keyCode==13&&!$(t).data("typeahead").shown&&h()})},r=function(e){$("#mainErrorMessage").text("Place '"+e+"' not found."),$("#mainErrorBox").show()},i=function(e){e===undefined?$("#compareErrorBox").hide():($("#compareErrorMessage").text("Place '"+e+"' not found for comparison."),$("#compareErrorBox").show())},s={},o=function(e,t){s.hasOwnProperty(e)?t(s[e]):d3.json("/region/"+e+".json",function(n){s[e]=n,t(n)})},u=function(e,n){var s=t[e.toLowerCase()],u=n!==undefined?t[n.toLowerCase()]:undefined;s===undefined&&u==undefined?(r(e),i(n)):s===undefined?(r(e),$("#compareErrorBox").hide()):u===undefined?($("#mainErrorBox").hide(),i(n)):($("#mainErrorBox").hide(),$("#compareErrorBox").hide()),$("#chart").empty(),$(".popover").remove();if(s!==undefined||u!=undefined)if(s!==undefined)if(u===undefined)$("#loadingBox").show(),o(s,function(t){renderChart(t,undefined,e,undefined),$("#loadingBox").hide()});else{$("#loadingBox").show();var a=undefined,f=undefined,l=function(){a!==undefined&&f!==undefined&&(renderChart(a,f,e,n),$("#loadingBox").hide())};o(s,function(e){a=e,l()}),o(u,function(e){f=e,l()})}};n("#select_main"),n("#select_compare");var a=function(e,t){var n={data_track_addressbar:!0,data_ga_social:!0,data_ga_property:"UA-69155-30"},r=undefined;t!==undefined?r={email_vars:{CustomText:"Age profile of "+e+" compared to "+t},email_template:"pop_pyramid",description:"Age profile of "+e+" compared to "+t,templates:{twitter:"Age profile of "+e+" compared to "+t+" {{url}} (vis by @jamiestarke @lgrammel)"}}:r={email_vars:{CustomText:"Age profile of "+e},email_template:"pop_pyramid",description:"Age profile of "+e,templates:{twitter:"Age profile of "+e+" {{url}} (vis by @jamiestarke @lgrammel)"}},$("#addthis").html('<a class="addthis_button_facebook"></a><a class="addthis_button_twitter"></a><a class="addthis_button_compact"></a>'),window.addthis.toolbox("#addthis",n,r)},f=function(e,t){t!==undefined?window.document.title=e+" compared to "+t+" - Canadian Population Pyramids":window.document.title=e+" Canadian Population Pyramid"},l=function(e,t){$("#select_main").val(e),$("#select_compare").val(t)},c=function(e,t){window._gaq.push(["_trackPageview",window.location.pathname+window.location.hash]),window._gat._getTrackerByName()._trackEvent("Region View",e,"Main Region"),window._gat._getTrackerByName()._trackEvent("Region View",t,"Comparison Region")},h=function(e,t){e===undefined&&(e=$("#select_main").val()),t===undefined&&(t=$("#select_compare").val());if(e==="")return;hasher.setHash(encodeURIComponent(e)+"/"+encodeURIComponent(t))},p=undefined,d=undefined,v=function(e,t){e=decodeURIComponent(e),t=t!==undefined?decodeURIComponent(t):undefined;if(e===p&&t===d)return;p=e,d=t,f(e,t),l(e,t),a(e,t),u(e,t),c(e,t)};crossroads.addRoute("/{mainName}/{compareName}",v),crossroads.addRoute("/{mainName}",v),crossroads.bypassed.add(function(){h("Capital, BC (CD)","Canada")});var m=function(e,t){crossroads.parse(e)};hasher.initialized.add(m),hasher.changed.add(m),hasher.init()}):($("#unsupportedBrowser").show(),$("#inputBar").hide())